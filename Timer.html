<div class="container">
  {#if !active}
    <input bind:value={timer} type="text" class="input" value={time()}>
  {/if}
  <button class="button" on:click={() => action()}>{active ? 'X' : '!'}</button>
</div>
{#if active}
  <svg class="timer" viewBox="0 0 56 18">
    <text x="0" y="15" class="timer-text">{hours > 0 ? hours+':' : ''}{minutes > 0 ? minutes+':' : ''}{seconds}</text>
  </svg>
{/if}
<script>
  let timer = ''
  let time
  let active = false
  let timeLeft
  let countdown
  let hours, minutes, seconds

  const action = () => {
    active = !active
    if (active) {
      timeLeft = parseInt(splitter()[0])*60+parseInt(splitter()[1])
      countdown = setInterval(() => {
        timeLeft -= 1
        console.log(timeLeft)
        if (timeLeft < 1) clearInterval(countdown)
      }, 1000)
    } else clearInterval(countdown)
  }
  $: time = () => timer.length >= 3 ? format() : timer
  $: {
    hours = ~~(timeLeft / 3600);
    minutes = (~~((timeLeft % 3600) / 60)).toLocaleString('de', {minimumIntegerDigits:2});
    seconds = (~~timeLeft % 60).toLocaleString('de', {minimumIntegerDigits:2})
  }
  const format = () => {
    const arr = timer.replace(':','').split('')
    arr.splice(-2, 0, ':')
    return arr.join('')
  }
  const splitter = () => time().includes(':') ? time().split(':') : [0, time()]
</script>
<style>
  .container { width: 100%; padding: 10px; box-sizing: border-box;}
  .input {width: 90%; box-sizing: border-box; display: inline-block}
  .button {position: absolute; right: 10px;width: 30px; display: inline-block}
  .timer {height: 100%}
</style>




